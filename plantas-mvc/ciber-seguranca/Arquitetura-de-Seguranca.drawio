<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2025-08-15T15:20:00.000Z" agent="5.0" etag="security-arch" version="21.6.5" type="device">
  <diagram name="Arquitetura-de-Seguranca" id="seguranca-arch">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="🔒 ARQUITETURA DE SEGURANÇA - DEFENSE IN DEPTH" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cc0000;strokeColor=#ff0000;fontSize=18;fontStyle=1;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="40" y="20" width="1080" height="50" as="geometry" />
        </mxCell>
        
        <!-- Internet Security Layer -->
        <mxCell id="internet-security" value="🌍 INTERNET SECURITY LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="90" width="1040" height="100" as="geometry" />
        </mxCell>
        
        <!-- DDoS Protection -->
        <mxCell id="ddos" value="🛡️ DDoS Protection&#xa;├── Type: Basic (included)&#xa;├── Protection: L3/L4&#xa;└── Mitigation: Automatic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- WAF -->
        <mxCell id="waf" value="🔥 Web Application Firewall&#xa;├── DEV: Disabled (cost opt.)&#xa;├── HML: Detection Mode&#xa;└── Rules: OWASP Top 10" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="320" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- SSL/TLS -->
        <mxCell id="ssl" value="🔐 SSL/TLS Termination&#xa;├── Certificates: Let's Encrypt&#xa;├── Version: TLS 1.2+&#xa;└── Ciphers: Strong only" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="560" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- Rate Limiting -->
        <mxCell id="rate-limit" value="⏱️ Rate Limiting&#xa;├── API: 1000 req/min&#xa;├── User: 100 req/min&#xa;└── IP: 500 req/min" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="800" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- Network Security Layer -->
        <mxCell id="network-security" value="🌐 NETWORK SECURITY LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="210" width="1040" height="160" as="geometry" />
        </mxCell>
        
        <!-- NSG DEV -->
        <mxCell id="nsg-dev" value="🛡️ NSG DEV (dev-nsg-isolated)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="250" width="480" height="110" as="geometry" />
        </mxCell>
        
        <!-- DEV Security Rules -->
        <mxCell id="dev-sec-rules" value="📋 DEV Security Rules&#xa;├── 🟢 ALLOW HTTPS (443) ← 10.100.0.0/16&#xa;├── 🟢 ALLOW SQL (1433) ← 10.100.1.0/24&#xa;├── 🔴 DENY ALL ← 10.0.0.0/8&#xa;├── 🔴 DENY RDP (3389) ← ANY&#xa;└── 🔴 DENY SSH (22) ← ANY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="100" y="280" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- DEV Priority Matrix -->
        <mxCell id="dev-priority" value="⚖️ Priority Matrix&#xa;100: Allow HTTPS Internal&#xa;110: Allow SQL Subnet&#xa;200: Deny Other Envs&#xa;4096: Allow VNet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="340" y="280" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- NSG HOMOLOG -->
        <mxCell id="nsg-hml" value="🛡️ NSG HML (hml-nsg-isolated)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="600" y="250" width="480" height="110" as="geometry" />
        </mxCell>
        
        <!-- HML Security Rules -->
        <mxCell id="hml-sec-rules" value="📋 HML Security Rules&#xa;├── 🟢 ALLOW HTTPS (443) ← 10.200.0.0/16&#xa;├── 🟢 ALLOW SQL (1433) ← 10.200.1.0/24&#xa;├── 🟢 ALLOW TEST (8080) ← 10.200.0.0/16&#xa;├── 🔴 DENY ALL ← 10.0.0.0/8&#xa;└── 🔴 DENY MGMT PORTS ← ANY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="620" y="280" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- HML Priority Matrix -->
        <mxCell id="hml-priority" value="⚖️ Priority Matrix&#xa;100: Allow HTTPS Internal&#xa;110: Allow SQL Subnet&#xa;120: Allow Test Port&#xa;200: Deny Other Envs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="860" y="280" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Identity & Access Management -->
        <mxCell id="iam-layer" value="🔐 IDENTITY & ACCESS MANAGEMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="390" width="1040" height="150" as="geometry" />
        </mxCell>
        
        <!-- Azure AD -->
        <mxCell id="azure-ad" value="👥 Azure Active Directory&#xa;├── Users: Developers only&#xa;├── Groups: dev-team, hml-team&#xa;├── MFA: Required&#xa;└── Conditional Access: Enabled" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Service Principal -->
        <mxCell id="sp-security" value="🤖 Service Principal&#xa;├── Name: sp-terraform-mvp-flex&#xa;├── Scope: Resource Groups only&#xa;├── Role: Contributor (limited)&#xa;└── Secret: Key Vault stored" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="320" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- RBAC -->
        <mxCell id="rbac" value="🔑 Role-Based Access Control&#xa;├── DEV: Reader + Limited Write&#xa;├── HML: Contributor + Testing&#xa;├── Prod: Owner only&#xa;└── Just-In-Time Access" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="560" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Key Vault Security -->
        <mxCell id="kv-security" value="🗝️ Key Vault Security&#xa;├── Access Policies: Restrictive&#xa;├── Soft Delete: Enabled&#xa;├── Purge Protection: Enabled&#xa;└── Network: Private Endpoint" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="800" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Data Security Layer -->
        <mxCell id="data-security" value="🗄️ DATA SECURITY LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="560" width="1040" height="130" as="geometry" />
        </mxCell>
        
        <!-- SQL Security -->
        <mxCell id="sql-security" value="🗄️ SQL Database Security&#xa;├── TDE: Enabled (Transparent Data Encryption)&#xa;├── Firewall: Azure services only&#xa;├── Auth: Azure AD + SQL Auth&#xa;├── Auditing: Enabled&#xa;└── Threat Detection: Basic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="600" width="240" height="80" as="geometry" />
        </mxCell>
        
        <!-- Storage Security -->
        <mxCell id="storage-security" value="💾 Storage Security&#xa;├── Encryption: AES-256 at rest&#xa;├── HTTPS: Required&#xa;├── Access: Private endpoints&#xa;├── SAS: Time-limited tokens&#xa;└── Blob: No public access" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="360" y="600" width="240" height="80" as="geometry" />
        </mxCell>
        
        <!-- Backup Security -->
        <mxCell id="backup-security" value="🔄 Backup & Recovery&#xa;├── SQL: Auto backup (HML only)&#xa;├── Storage: Geo-redundant&#xa;├── Retention: 7 days (HML)&#xa;├── Point-in-time: Enabled&#xa;└── Cross-region: Disabled (cost)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="640" y="600" width="240" height="80" as="geometry" />
        </mxCell>
        
        <!-- Monitoring Security -->
        <mxCell id="monitoring-security" value="📊 Security Monitoring&#xa;├── App Insights: Security events&#xa;├── Log Analytics: Centralized&#xa;├── Alerts: Failed logins, anomalies&#xa;├── Retention: 30 days&#xa;└── SIEM: Basic correlation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="920" y="600" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- Compliance & Governance -->
        <mxCell id="compliance" value="📋 COMPLIANCE & GOVERNANCE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="710" width="1040" height="80" as="geometry" />
        </mxCell>
        
        <!-- Security Policies -->
        <mxCell id="policies" value="📜 Security Policies&#xa;├── Password: Complex, 90-day expiry&#xa;├── Network: Least privilege&#xa;├── Data: Classification required&#xa;└── Incident: Response plan" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Cost vs Security -->
        <mxCell id="cost-security" value="💰 Cost vs Security Balance&#xa;├── DEV: Basic security (cost-first)&#xa;├── HML: Standard security&#xa;├── Audit: Monthly reviews&#xa;└── Optimization: Continuous" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Threat Model -->
        <mxCell id="threat-model" value="⚠️ Threat Model&#xa;├── OWASP Top 10 coverage&#xa;├── Data breaches: Medium risk&#xa;├── DDoS: Low risk (Basic protection)&#xa;└── Insider threats: Controlled" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="560" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Security Maturity -->
        <mxCell id="maturity" value="📈 Security Maturity Level&#xa;├── Current: Level 2 (Managed)&#xa;├── Target: Level 3 (Defined)&#xa;├── Assessment: Quarterly&#xa;└── Improvement: Iterative" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="800" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Security Flow Lines -->
        <mxCell id="security-flow1" value="Defense in Depth" style="endArrow=classic;html=1;strokeColor=#cc0000;strokeWidth=3;fontSize=12;fontStyle=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="40" y="140" as="sourcePoint" />
            <mxPoint x="40" y="760" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
