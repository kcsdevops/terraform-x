<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2025-08-15T15:20:00.000Z" agent="5.0" etag="security-arch" version="21.6.5" type="device">
  <diagram name="Arquitetura-de-Seguranca" id="seguranca-arch">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="ðŸ”’ ARQUITETURA DE SEGURANÃ‡A - DEFENSE IN DEPTH" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#cc0000;strokeColor=#ff0000;fontSize=18;fontStyle=1;fontColor=#ffffff;" vertex="1" parent="1">
          <mxGeometry x="40" y="20" width="1080" height="50" as="geometry" />
        </mxCell>
        
        <!-- Internet Security Layer -->
        <mxCell id="internet-security" value="ðŸŒ INTERNET SECURITY LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="90" width="1040" height="100" as="geometry" />
        </mxCell>
        
        <!-- DDoS Protection -->
        <mxCell id="ddos" value="ðŸ›¡ï¸ DDoS Protection&#xa;â”œâ”€â”€ Type: Basic (included)&#xa;â”œâ”€â”€ Protection: L3/L4&#xa;â””â”€â”€ Mitigation: Automatic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- WAF -->
        <mxCell id="waf" value="ðŸ”¥ Web Application Firewall&#xa;â”œâ”€â”€ DEV: Disabled (cost opt.)&#xa;â”œâ”€â”€ HML: Detection Mode&#xa;â””â”€â”€ Rules: OWASP Top 10" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="320" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- SSL/TLS -->
        <mxCell id="ssl" value="ðŸ” SSL/TLS Termination&#xa;â”œâ”€â”€ Certificates: Let's Encrypt&#xa;â”œâ”€â”€ Version: TLS 1.2+&#xa;â””â”€â”€ Ciphers: Strong only" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="560" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- Rate Limiting -->
        <mxCell id="rate-limit" value="â±ï¸ Rate Limiting&#xa;â”œâ”€â”€ API: 1000 req/min&#xa;â”œâ”€â”€ User: 100 req/min&#xa;â””â”€â”€ IP: 500 req/min" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="800" y="130" width="200" height="50" as="geometry" />
        </mxCell>
        
        <!-- Network Security Layer -->
        <mxCell id="network-security" value="ðŸŒ NETWORK SECURITY LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="210" width="1040" height="160" as="geometry" />
        </mxCell>
        
        <!-- NSG DEV -->
        <mxCell id="nsg-dev" value="ðŸ›¡ï¸ NSG DEV (dev-nsg-isolated)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="250" width="480" height="110" as="geometry" />
        </mxCell>
        
        <!-- DEV Security Rules -->
        <mxCell id="dev-sec-rules" value="ðŸ“‹ DEV Security Rules&#xa;â”œâ”€â”€ ðŸŸ¢ ALLOW HTTPS (443) â† 10.100.0.0/16&#xa;â”œâ”€â”€ ðŸŸ¢ ALLOW SQL (1433) â† 10.100.1.0/24&#xa;â”œâ”€â”€ ðŸ”´ DENY ALL â† 10.0.0.0/8&#xa;â”œâ”€â”€ ðŸ”´ DENY RDP (3389) â† ANY&#xa;â””â”€â”€ ðŸ”´ DENY SSH (22) â† ANY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="100" y="280" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- DEV Priority Matrix -->
        <mxCell id="dev-priority" value="âš–ï¸ Priority Matrix&#xa;100: Allow HTTPS Internal&#xa;110: Allow SQL Subnet&#xa;200: Deny Other Envs&#xa;4096: Allow VNet" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="340" y="280" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- NSG HOMOLOG -->
        <mxCell id="nsg-hml" value="ðŸ›¡ï¸ NSG HML (hml-nsg-isolated)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="600" y="250" width="480" height="110" as="geometry" />
        </mxCell>
        
        <!-- HML Security Rules -->
        <mxCell id="hml-sec-rules" value="ðŸ“‹ HML Security Rules&#xa;â”œâ”€â”€ ðŸŸ¢ ALLOW HTTPS (443) â† 10.200.0.0/16&#xa;â”œâ”€â”€ ðŸŸ¢ ALLOW SQL (1433) â† 10.200.1.0/24&#xa;â”œâ”€â”€ ðŸŸ¢ ALLOW TEST (8080) â† 10.200.0.0/16&#xa;â”œâ”€â”€ ðŸ”´ DENY ALL â† 10.0.0.0/8&#xa;â””â”€â”€ ðŸ”´ DENY MGMT PORTS â† ANY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="620" y="280" width="220" height="70" as="geometry" />
        </mxCell>
        
        <!-- HML Priority Matrix -->
        <mxCell id="hml-priority" value="âš–ï¸ Priority Matrix&#xa;100: Allow HTTPS Internal&#xa;110: Allow SQL Subnet&#xa;120: Allow Test Port&#xa;200: Deny Other Envs" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="860" y="280" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Identity & Access Management -->
        <mxCell id="iam-layer" value="ðŸ” IDENTITY & ACCESS MANAGEMENT" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="390" width="1040" height="150" as="geometry" />
        </mxCell>
        
        <!-- Azure AD -->
        <mxCell id="azure-ad" value="ðŸ‘¥ Azure Active Directory&#xa;â”œâ”€â”€ Users: Developers only&#xa;â”œâ”€â”€ Groups: dev-team, hml-team&#xa;â”œâ”€â”€ MFA: Required&#xa;â””â”€â”€ Conditional Access: Enabled" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="80" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Service Principal -->
        <mxCell id="sp-security" value="ðŸ¤– Service Principal&#xa;â”œâ”€â”€ Name: sp-terraform-mvp-flex&#xa;â”œâ”€â”€ Scope: Resource Groups only&#xa;â”œâ”€â”€ Role: Contributor (limited)&#xa;â””â”€â”€ Secret: Key Vault stored" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="320" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- RBAC -->
        <mxCell id="rbac" value="ðŸ”‘ Role-Based Access Control&#xa;â”œâ”€â”€ DEV: Reader + Limited Write&#xa;â”œâ”€â”€ HML: Contributor + Testing&#xa;â”œâ”€â”€ Prod: Owner only&#xa;â””â”€â”€ Just-In-Time Access" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="560" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Key Vault Security -->
        <mxCell id="kv-security" value="ðŸ—ï¸ Key Vault Security&#xa;â”œâ”€â”€ Access Policies: Restrictive&#xa;â”œâ”€â”€ Soft Delete: Enabled&#xa;â”œâ”€â”€ Purge Protection: Enabled&#xa;â””â”€â”€ Network: Private Endpoint" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="800" y="430" width="200" height="70" as="geometry" />
        </mxCell>
        
        <!-- Data Security Layer -->
        <mxCell id="data-security" value="ðŸ—„ï¸ DATA SECURITY LAYER" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="560" width="1040" height="130" as="geometry" />
        </mxCell>
        
        <!-- SQL Security -->
        <mxCell id="sql-security" value="ðŸ—„ï¸ SQL Database Security&#xa;â”œâ”€â”€ TDE: Enabled (Transparent Data Encryption)&#xa;â”œâ”€â”€ Firewall: Azure services only&#xa;â”œâ”€â”€ Auth: Azure AD + SQL Auth&#xa;â”œâ”€â”€ Auditing: Enabled&#xa;â””â”€â”€ Threat Detection: Basic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="600" width="240" height="80" as="geometry" />
        </mxCell>
        
        <!-- Storage Security -->
        <mxCell id="storage-security" value="ðŸ’¾ Storage Security&#xa;â”œâ”€â”€ Encryption: AES-256 at rest&#xa;â”œâ”€â”€ HTTPS: Required&#xa;â”œâ”€â”€ Access: Private endpoints&#xa;â”œâ”€â”€ SAS: Time-limited tokens&#xa;â””â”€â”€ Blob: No public access" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="360" y="600" width="240" height="80" as="geometry" />
        </mxCell>
        
        <!-- Backup Security -->
        <mxCell id="backup-security" value="ðŸ”„ Backup & Recovery&#xa;â”œâ”€â”€ SQL: Auto backup (HML only)&#xa;â”œâ”€â”€ Storage: Geo-redundant&#xa;â”œâ”€â”€ Retention: 7 days (HML)&#xa;â”œâ”€â”€ Point-in-time: Enabled&#xa;â””â”€â”€ Cross-region: Disabled (cost)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="640" y="600" width="240" height="80" as="geometry" />
        </mxCell>
        
        <!-- Monitoring Security -->
        <mxCell id="monitoring-security" value="ðŸ“Š Security Monitoring&#xa;â”œâ”€â”€ App Insights: Security events&#xa;â”œâ”€â”€ Log Analytics: Centralized&#xa;â”œâ”€â”€ Alerts: Failed logins, anomalies&#xa;â”œâ”€â”€ Retention: 30 days&#xa;â””â”€â”€ SIEM: Basic correlation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="920" y="600" width="160" height="80" as="geometry" />
        </mxCell>
        
        <!-- Compliance & Governance -->
        <mxCell id="compliance" value="ðŸ“‹ COMPLIANCE & GOVERNANCE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcc99;strokeColor=#ff6600;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=10;" vertex="1" parent="1">
          <mxGeometry x="60" y="710" width="1040" height="80" as="geometry" />
        </mxCell>
        
        <!-- Security Policies -->
        <mxCell id="policies" value="ðŸ“œ Security Policies&#xa;â”œâ”€â”€ Password: Complex, 90-day expiry&#xa;â”œâ”€â”€ Network: Least privilege&#xa;â”œâ”€â”€ Data: Classification required&#xa;â””â”€â”€ Incident: Response plan" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="80" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Cost vs Security -->
        <mxCell id="cost-security" value="ðŸ’° Cost vs Security Balance&#xa;â”œâ”€â”€ DEV: Basic security (cost-first)&#xa;â”œâ”€â”€ HML: Standard security&#xa;â”œâ”€â”€ Audit: Monthly reviews&#xa;â””â”€â”€ Optimization: Continuous" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="320" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Threat Model -->
        <mxCell id="threat-model" value="âš ï¸ Threat Model&#xa;â”œâ”€â”€ OWASP Top 10 coverage&#xa;â”œâ”€â”€ Data breaches: Medium risk&#xa;â”œâ”€â”€ DDoS: Low risk (Basic protection)&#xa;â””â”€â”€ Insider threats: Controlled" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="560" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Security Maturity -->
        <mxCell id="maturity" value="ðŸ“ˆ Security Maturity Level&#xa;â”œâ”€â”€ Current: Level 2 (Managed)&#xa;â”œâ”€â”€ Target: Level 3 (Defined)&#xa;â”œâ”€â”€ Assessment: Quarterly&#xa;â””â”€â”€ Improvement: Iterative" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="800" y="750" width="200" height="30" as="geometry" />
        </mxCell>
        
        <!-- Security Flow Lines -->
        <mxCell id="security-flow1" value="Defense in Depth" style="endArrow=classic;html=1;strokeColor=#cc0000;strokeWidth=3;fontSize=12;fontStyle=1;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="40" y="140" as="sourcePoint" />
            <mxPoint x="40" y="760" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
